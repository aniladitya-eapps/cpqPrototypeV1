<apex:page controller="QuotePrintablePdfCtrl"
           renderAs="pdf"
           showHeader="false"
           standardStylesheets="false"
           applyHtmlTag="false">

  <style type="text/css">
    @page { margin: 14mm; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .header { width: 100%; margin-bottom: 8px; }
    .header .left { float: left; }
    .header .right { float: right; text-align: right; }
    .clearfix { clear: both; }
    h2 { font-size: 16px; margin: 16px 0 8px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 6px; }
    th { background: #f6f6f6; text-align: left; }
    .no-border td { border: none; padding-left: 0; }
    .half { width: 50%; vertical-align: top; }
    .rightTxt { text-align: right; }
    .section { margin-top: 12px; }
    .terms { white-space: pre-wrap; line-height: 1.4; }
    .empty { color:#777; font-style: italic; text-align:center; }
  </style>

  <!-- Header -->
  <div class="header">
    <div class="left"><strong>Quote</strong></div>
    <div class="right">
      <apex:outputText rendered="{!NOT(ISBLANK(payload.quoteNumber))}"
                       value="Quote #: {!payload.quoteNumber}"/><br/>
      <apex:outputText rendered="{!NOT(ISBLANK(payload.quoteId))}"
                       value="Quote Id: {!payload.quoteId}"/>
    </div>
  </div>
  <div class="clearfix"></div>
  <hr/>

  <!-- Section 1: Addresses -->
  <div class="section">
    <h2>Bill To / Ship To</h2>
    <table class="no-border">
      <tr>
        <td class="half">
          <strong>Bill To</strong><br/>
          <apex:outputText value="{!billToStreet}" escape="true"/><br/>
          <apex:outputText value="{!billToCity}" escape="true"/>,
          <apex:outputText value="{!billToState}" escape="true"/>
          <apex:outputText value="{!billToPostalCode}" escape="true"/><br/>
          <apex:outputText value="{!billToCountry}" escape="true"/>
        </td>
        <td class="half">
          <strong>Ship To</strong><br/>
          <apex:outputText value="{!shipToStreet}" escape="true"/><br/>
          <apex:outputText value="{!shipToCity}" escape="true"/>,
          <apex:outputText value="{!shipToState}" escape="true"/>
          <apex:outputText value="{!shipToPostalCode}" escape="true"/><br/>
          <apex:outputText value="{!shipToCountry}" escape="true"/>
        </td>
      </tr>
    </table>
  </div>

  <!-- Section 2: Items -->
  <div class="section">
    <h2>Items</h2>
    <table>
      <thead>
        <tr>
          <th>Product Code</th>
          <th class="rightTxt">Quantity</th>
          <th class="rightTxt">Unit Price</th>
          <th class="rightTxt">Discount</th>
          <th class="rightTxt">Net Total</th>
        </tr>
      </thead>
      <tbody>
        <apex:outputPanel rendered="{!NOT(ISBLANK(payload.items))}">
          <apex:repeat value="{!payload.items}" var="li">
            <tr>
              <td><apex:outputText value="{!li.ProductCode}" escape="true"/></td>
              <td class="rightTxt"><apex:outputText value="{!li.Quantity}"/></td>
              <td class="rightTxt">$<apex:outputText value="{!li.UnitPrice}"/></td>
              <td class="rightTxt">
                <apex:outputText value="{!IF(li.DiscountType='Amount',
                                             '$' & TEXT(li.DiscountValue),
                                             TEXT(li.DiscountValue) & '%')}"/>
              </td>
              <td class="rightTxt">$<apex:outputText value="{!li.NetPrice}"/></td>
            </tr>
          </apex:repeat>
        </apex:outputPanel>
        <apex:outputPanel rendered="{!ISBLANK(payload.items)}">
          <tr><td class="empty" colspan="5">No items</td></tr>
        </apex:outputPanel>
      </tbody>
    </table>
  </div>

  <!-- Section 3: Terms -->
  <div class="section">
    <h2>Terms and Conditions</h2>
    <div class="terms">
      <apex:outputText value="{!payload.terms}" escape="true"/>
    </div>
  </div>
</apex:page>
